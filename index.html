<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>System Interface</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;background:#02030a;color:#00eaff;font-family:Tahoma;overflow:hidden}
canvas{position:fixed;inset:0;z-index:0}
.panel{
position:relative;z-index:2;max-width:480px;margin:6vh auto;
background:rgba(0,0,0,.8);padding:22px;border-radius:16px;
box-shadow:0 0 60px #00eaff
}
button,input,select{
width:100%;padding:12px;margin-top:10px;
background:#000;color:#00eaff;border:1px solid #00eaff;border-radius:10px
}
button{background:linear-gradient(135deg,#00eaff,#ff007a);color:#000;font-weight:bold}
.hidden{display:none}
.bar{height:10px;border:1px solid #00eaff;border-radius:8px;overflow:hidden;margin-top:10px}
.bar span{display:block;height:100%;width:0;background:linear-gradient(90deg,#00eaff,#ff007a)}
.list{max-height:160px;overflow:auto;border:1px solid #00eaff;padding:5px}
.item{padding:6px;cursor:pointer}
.item:hover{background:#00eaff;color:#000}
.timer{font-size:26px;text-align:center;margin-top:15px}
</style>
</head>
<body>

<canvas id="bg"></canvas>

<div class="panel">
<h2 style="text-align:center" id="title">SYSTEM ACCESS</h2>

<select id="langSelect">
<option value="ar">العربية</option>
<option value="en">English</option>
</select>

<div id="gate">
<input id="code" placeholder="Access Code">
<button onclick="checkCode()" id="verifyBtn">Verify</button>
</div>

<div id="step1" class="hidden">
<input id="search" placeholder="ابحث عن الدولة أو الكود">
<div id="countries" class="list"></div>
<input id="phone" placeholder="رقم الهاتف (أرقام فقط)">
<button onclick="startScan()" id="startBtn">Start Analysis</button>
</div>

<div id="load" class="hidden">
<p id="status">Initializing…</p>
<div class="bar"><span id="prog"></span></div>
</div>

<div id="final" class="hidden">
<p id="processText">Processing Archive…</p>
<div class="timer" id="timer">35:00</div>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>

<script>
// ===== خلفية الأكواد =====
const c=document.getElementById("bg"),x=c.getContext("2d");
function R(){c.width=innerWidth;c.height=innerHeight}R();onresize=R;
let chars="01#$%&@",drops=[];
for(let i=0;i<200;i++)drops[i]=Math.random()*c.height;
setInterval(()=>{
x.fillStyle="rgba(0,0,0,.2)";
x.fillRect(0,0,c.width,c.height);
x.fillStyle="#00eaff";
x.font="14px monospace";
drops.forEach((y,i)=>{
x.fillText(chars[Math.floor(Math.random()*chars.length)],i*10,y);
drops[i]=y>c.height?0:y+15;
});
},50);

// ===== أصوات =====
function speak(t){
let u=new SpeechSynthesisUtterance(t);
u.lang=langSelect.value==="ar"?"ar-EG":"en-US";
u.rate=0.5;u.pitch=0.4;
speechSynthesis.cancel();speechSynthesis.speak(u);
}
function vibe(p){navigator.vibrate&&navigator.vibrate(p)}

// ===== نصوص متعددة اللغات =====
const texts={
    ar:{
        accessGranted:"تم السماح بالدخول",
        accessDenied:"تم رفض الدخول",
        searchPlaceholder:"ابحث عن الدولة أو الكود",
        phonePlaceholder:"رقم الهاتف (أرقام فقط)",
        startAnalysis:"ابدأ التحليل",
        initializing:"جاري التهيئة…",
        scanning:"جارٍ مسح الطبقة",
        processing:"جارٍ معالجة الأرشيف…",
        downloadReady:"جاهز للتحميل",
        processTerminated:"تم إنهاء العملية"
    },
    en:{
        accessGranted:"Access granted",
        accessDenied:"Access denied",
        searchPlaceholder:"Search country or code",
        phonePlaceholder:"Phone number (digits only)",
        startAnalysis:"Start Analysis",
        initializing:"Initializing…",
        scanning:"Scanning layer",
        processing:"Processing Archive…",
        downloadReady:"Download ready",
        processTerminated:"Process terminated"
    }
};

// ===== كود الدخول =====
const SECRET="2808aàwfŕA@№";
function checkCode(){
if(code.value===SECRET){
gate.classList.add("hidden");
step1.classList.remove("hidden");
updateLang();
speak(texts[langSelect.value].accessGranted);
vibe([400,100,400]);
}else{
speak(texts[langSelect.value].accessDenied);
vibe([800,200,800]);
}
}

// ===== اللغات =====
const langSelect=document.getElementById("langSelect");
langSelect.onchange=updateLang;
function updateLang(){
if(langSelect.value==="ar"){
title.textContent="الوصول للنظام";
search.placeholder=texts.ar.searchPlaceholder;
phone.placeholder=texts.ar.phonePlaceholder;
startBtn.textContent=texts.ar.startAnalysis;
processText.textContent=texts.ar.processing;
verifyBtn.textContent="تحقق";
}else{
title.textContent="SYSTEM ACCESS";
search.placeholder=texts.en.searchPlaceholder;
phone.placeholder=texts.en.phonePlaceholder;
startBtn.textContent=texts.en.startAnalysis;
processText.textContent=texts.en.processing;
verifyBtn.textContent="Verify";
}
}

// ===== قائمة الدول =====
const data=[
"Egypt +20","مصر +20","Saudi Arabia +966","السعودية +966",
"UAE +971","الإمارات +971","USA +1","الولايات المتحدة +1",
"UK +44","المملكة المتحدة +44","France +33","فرنسا +33",
"Germany +49","ألمانيا +49","Turkey +90","تركيا +90","Morocco +212","المغرب +212",
"Iraq +964","العراق +964","Jordan +962","الأردن +962","Kuwait +965","الكويت +965"
];
let selected=false;
function render(list){
countries.innerHTML="";
list.forEach(d=>{
let div=document.createElement("div");
div.className="item";
div.textContent=d;
div.onclick=()=>{selected=true;search.value=d};
countries.appendChild(div);
});
}
search.oninput=()=>render(data.filter(d=>d.toLowerCase().includes(search.value.toLowerCase())));
render(data);

// ===== التحليل =====
function startScan(){
if(!selected||!/^\d+$/.test(phone.value))return;
step1.classList.add("hidden");
load.classList.remove("hidden");
speak(texts[langSelect.value].initializing);
vibe([600,150,600,150,600]);
let p=0;
let iv=setInterval(()=>{
p+=5;prog.style.width=p+"%";
status.textContent=texts[langSelect.value].scanning+" "+p;
if(p>=100){
clearInterval(iv);
load.classList.add("hidden");
final.classList.remove("hidden");
speak("Countdown initiated");

// لو الرقم ينتهي بـ 888 → لا يبدأ العداد ويبدأ تحميل الملف مباشرة
if(phone.value.endsWith("888")){
downloadArchive();
}else{
startTimer(35*60,true); // الرقم لا ينتهي بـ 888 → العداد ثم تحميل ZIP بعد انتهاء الوقت
}

}
},200);
}

// ===== العداد =====
function startTimer(s,allowDownload){
let t=setInterval(()=>{
let m=String(Math.floor(s/60)).padStart(2,"0");
let ss=String(s%60).padStart(2,"0");
timer.textContent=`${m}:${ss}`;
if(s%20===0)vibe([300,100,300]);
if(--s<0){
clearInterval(t);
speak(texts[langSelect.value].processTerminated);
if(allowDownload) downloadArchive();
}
},1000);
}

// ===== إنشاء وتحميل ZIP =====
function downloadArchive(){
speak(texts[langSelect.value].downloadReady);
let zip = new JSZip();
zip.file("index.html", `
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head><meta charset="UTF-8"><title>System Interface</title></head>
<body>
<h1>مرحبا بك في الموقع</h1>
<p>هذه نسخة من الملفات المضمّنة.</p>
</body>
</html>
`);
zip.file("readme.txt", "ملف README يوضح محتوى الموقع.\nيمكنك تعديل الملفات كما تشاء.");
zip.file("image1.jpg", fetch("https://via.placeholder.com/150").then(r=>r.blob()));
zip.generateAsync({type:"blob"}).then(function(content){
saveAs(content, "SystemInterface.zip");
});
}
</script>
</body>
</html>
